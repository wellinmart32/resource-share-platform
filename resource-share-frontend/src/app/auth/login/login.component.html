<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Iniciar Sesión</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="login-container">
    
    <!-- Logo o título -->
    <div class="text-center mb-4">
      <h1>CompartirRecursos</h1>
      <p class="text-muted">Plataforma de Donación</p>
    </div>

    <!-- Formulario -->
    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
      
      <!-- Email -->
      <ion-item>
        <ion-label position="floating">Email</ion-label>
        <ion-input 
          type="email" 
          formControlName="email"
          placeholder="ejemplo@correo.com">
        </ion-input>
      </ion-item>
      <ion-text color="danger" *ngIf="hasError('email', 'required')">
        <small>El email es requerido</small>
      </ion-text>
      <ion-text color="danger" *ngIf="hasError('email', 'email')">
        <small>Email inválido</small>
      </ion-text>

      <!-- Contraseña -->
      <ion-item class="mt-3">
        <ion-label position="floating">Contraseña</ion-label>
        <ion-input 
          [type]="showPassword ? 'text' : 'password'" 
          formControlName="password"
          placeholder="Mínimo 6 caracteres">
        </ion-input>
        <ion-button 
          slot="end" 
          fill="clear" 
          (click)="togglePasswordVisibility()">
          <ion-icon 
            [name]="showPassword ? 'eye-off-outline' : 'eye-outline'">
          </ion-icon>
        </ion-button>
      </ion-item>
      <ion-text color="danger" *ngIf="hasError('password', 'required')">
        <small>La contraseña es requerida</small>
      </ion-text>
      <ion-text color="danger" *ngIf="hasError('password', 'minlength')">
        <small>Mínimo 6 caracteres</small>
      </ion-text>

      <!-- Mensaje de error -->
      <ion-text color="danger" *ngIf="errorMessage" class="d-block mt-3">
        <p class="ion-text-center">
          <ion-icon name="alert-circle-outline"></ion-icon>
          {{ errorMessage }}
        </p>
      </ion-text>

      <!-- Botón Login -->
      <ion-button 
        expand="block" 
        type="submit" 
        class="mt-4"
        [disabled]="isLoading">
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
        <span *ngIf="!isLoading">Iniciar Sesión</span>
      </ion-button>

    </form>

    <!-- Link a Registro -->
    <div class="text-center mt-4">
      <p>
        ¿No tienes cuenta? 
        <ion-button fill="clear" (click)="goToRegister()">
          Regístrate aquí
        </ion-button>
      </p>
    </div>

  </div>
</ion-content>
